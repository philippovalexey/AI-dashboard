import streamlit as st
import pandas as pd
import altair as alt

st.set_page_config(layout="wide")
st.image("https://upload.wikimedia.org/wikipedia/commons/2/2d/Alfa-Bank_Logo_2021.svg", width=150)

st.title("AI Operations Dashboard ‚Äì –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫")
st.markdown("### –§–∏–Ω–∞–Ω—Å–æ–≤–æ-–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è AI-–ø—Ä–æ–µ–∫—Ç–∞–º–∏ (2025‚Äì2028)")

# -------------------------------
# 1. P&L –°—Ç—Ä—É–∫—Ç—É—Ä–∞
# -------------------------------
st.header("üìä –≠–∫–æ–Ω–æ–º–∏–∫–∞ –ò–ò (P&L-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)")

col1, col2 = st.columns(2)

with col1:
    pnl_data = pd.DataFrame({
        "–ì–æ–¥": [2025, 2026, 2027, 2028],
        "–í—ã—Ä—É—á–∫–∞ –±–∞–Ω–∫–∞, –º–ª–Ω ‚ÇΩ": [600_000, 660_000, 730_000, 810_000],
        "AI-–≤—ã—Ä—É—á–∫–∞, –º–ª–Ω ‚ÇΩ": [7_200, 13_860, 25_550, 40_500]
    })
    st.altair_chart(
        alt.Chart(pnl_data).transform_fold(
            ["–í—ã—Ä—É—á–∫–∞ –±–∞–Ω–∫–∞, –º–ª–Ω ‚ÇΩ", "AI-–≤—ã—Ä—É—á–∫–∞, –º–ª–Ω ‚ÇΩ"],
            as_=["–ö–∞—Ç–µ–≥–æ—Ä–∏—è", "–ó–Ω–∞—á–µ–Ω–∏–µ"]
        ).mark_bar().encode(
            x="–ì–æ–¥:O",
            y="–ó–Ω–∞—á–µ–Ω–∏–µ:Q",
            color="–ö–∞—Ç–µ–≥–æ—Ä–∏—è:N"
        ).properties(width=500, height=300),
        use_container_width=True
    )

with col2:
    economy_effect = pd.DataFrame({
        "–ì–æ–¥": [2025, 2026, 2027, 2028],
        "–≠–∫–æ–Ω–æ–º–∏—è –∑–∞—Ç—Ä–∞—Ç, –º–ª–Ω ‚ÇΩ": [1_200, 2_400, 4_000, 6_000],
        "–î–æ–ø. –¥–æ—Ö–æ–¥ –æ—Ç LLM, –º–ª–Ω ‚ÇΩ": [1_500, 3_000, 5_500, 9_000]
    })
    st.altair_chart(
        alt.Chart(economy_effect).transform_fold(
            ["–≠–∫–æ–Ω–æ–º–∏—è –∑–∞—Ç—Ä–∞—Ç, –º–ª–Ω ‚ÇΩ", "–î–æ–ø. –¥–æ—Ö–æ–¥ –æ—Ç LLM, –º–ª–Ω ‚ÇΩ"],
            as_=["–ú–µ—Ç—Ä–∏–∫–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ"]
        ).mark_line(point=True).encode(
            x="–ì–æ–¥:O",
            y="–ó–Ω–∞—á–µ–Ω–∏–µ:Q",
            color="–ú–µ—Ç—Ä–∏–∫–∞:N"
        ).properties(width=500, height=300),
        use_container_width=True
    )

# -------------------------------
# 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤
# -------------------------------
st.header("üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ MECE-–¥–µ—Ä–µ–≤—É")

spending = pd.DataFrame({
    "–ö–∞—Ç–µ–≥–æ—Ä–∏—è": ["R&D", "–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞", "–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞", "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏"],
    "2025": [2_000, 3_500, 1_000, 500],
    "2026": [2_400, 3_800, 1_200, 600]
})

st.dataframe(spending.set_index("–ö–∞—Ç–µ–≥–æ—Ä–∏—è"))

# -------------------------------
# 3. KPI –ø–æ –∫–æ–º–∞–Ω–¥–∞–º (–ø–ª–∞–Ω/—Ñ–∞–∫—Ç + RAG)
# -------------------------------
st.header("üìå KPI –∫–æ–º–∞–Ω–¥ AI (–ü–ª–∞–Ω / –§–∞–∫—Ç / –°—Ç–∞—Ç—É—Å)")

kpi_data = pd.DataFrame({
    "–ö–æ–º–∞–Ω–¥–∞": ["NLP", "MLOps", "DevOps", "PM"],
    "–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å": ["Precision", "CI/CD %", "–ê–ø—Ç–∞–π–º %", "–ö–æ–ª-–≤–æ MVP"],
    "–ü–ª–∞–Ω": [0.92, 0.97, 99.9, 8],
    "–§–∞–∫—Ç": [0.89, 0.95, 99.5, 6],
    "RAG": ["Amber", "Amber", "Green", "Red"]
})

def color_rag(val):
    colors = {
        "Red": "background-color: #f8d7da",
        "Amber": "background-color: #fff3cd",
        "Green": "background-color: #d4edda"
    }
    return colors.get(val, "")

st.dataframe(kpi_data.style.applymap(color_rag, subset=["RAG"]))

# -------------------------------
# 4. –ü—Ä–æ–≤–∞–ª –≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (mock)
# -------------------------------
st.header("üßë‚Äçüíª –í–∫–ª–∞–¥ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤")

team_choice = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É", ["NLP", "MLOps", "DevOps", "PM"])
mock_employees = {
    "NLP": pd.DataFrame({
        "–°–æ—Ç—Ä—É–¥–Ω–∏–∫": ["–ò–≤–∞–Ω–æ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–∏–¥–æ—Ä–æ–≤"],
        "–ó–∞–∫—Ä—ã—Ç–æ –∑–∞–¥–∞—á": [25, 30, 28]
    }),
    "MLOps": pd.DataFrame({
        "–°–æ—Ç—Ä—É–¥–Ω–∏–∫": ["–ù–æ–≤–∏–∫–æ–≤–∞", "–§—Ä–æ–ª–æ–≤"],
        "–ó–∞–∫—Ä—ã—Ç–æ –∑–∞–¥–∞—á": [40, 35]
    }),
    "DevOps": pd.DataFrame({
        "–°–æ—Ç—Ä—É–¥–Ω–∏–∫": ["–û—Ä–ª–æ–≤", "–ú–æ—Ä–æ–∑–æ–≤", "–ó–∞–π—Ü–µ–≤–∞"],
        "–ó–∞–∫—Ä—ã—Ç–æ –∑–∞–¥–∞—á": [20, 18, 25]
    }),
    "PM": pd.DataFrame({
        "–°–æ—Ç—Ä—É–¥–Ω–∏–∫": ["–°–µ–º–µ–Ω–æ–≤", "–ì—Ä–∏–≥–æ—Ä—å–µ–≤–∞"],
        "–ó–∞–∫—Ä—ã—Ç–æ –∑–∞–¥–∞—á": [10, 12]
    })
}

st.bar_chart(mock_employees[team_choice].set_index("–°–æ—Ç—Ä—É–¥–Ω–∏–∫"))

st.markdown("---")
st.caption("¬© 2025 –§–∏–Ω–∞–Ω—Å–æ–≤–æ-–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ AI-–ø—Ä–æ–µ–∫—Ç–æ–≤. –ú–æ–∫-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π.")